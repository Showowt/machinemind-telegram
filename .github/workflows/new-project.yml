name: New Project Generator

on:
  workflow_dispatch:
    inputs:
      business_name:
        description: 'Business name'
        required: true
        type: string
      sector:
        description: 'Business sector'
        required: true
        type: string
      chat_id:
        description: 'Telegram chat ID'
        required: true
        type: string
      location:
        description: 'Business location'
        required: false
        type: string
        default: 'Cartagena, Colombia'

env:
  ANTHROPIC_API_KEY: ${{ secrets.ANTHROPIC_API_KEY }}

jobs:
  notify-start:
    runs-on: ubuntu-latest
    steps:
      - run: |
          curl -s -X POST "https://api.telegram.org/bot${{ secrets.TELEGRAM_BOT_TOKEN }}/sendMessage" \
            -H "Content-Type: application/json" \
            -d '{
              "chat_id": "${{ inputs.chat_id }}",
              "text": "‚ö° <b>GENESIS ENGINE ACTIVATED</b>\n\nüè¢ Business: <code>${{ inputs.business_name }}</code>\nüéØ Sector: <code>${{ inputs.sector }}</code>\nüìç Location: ${{ inputs.location }}\n\n<b>Spawning Build Swarm:</b>\n‚Ä¢ üîç Research Agent\n‚Ä¢ üèóÔ∏è Architect Agent\n‚Ä¢ üé® Design Agent\n‚Ä¢ üíª Code Agent\n‚Ä¢ üöÄ Deploy Agent\n\n‚è±Ô∏è ETA: 3-4 minutes\n\n<i>Powered by PROMETHEUS v2 + APEX v6</i>",
              "parse_mode": "HTML"
            }'

  create-project:
    runs-on: ubuntu-latest
    outputs:
      repo_name: ${{ steps.setup.outputs.repo_name }}
      slug: ${{ steps.setup.outputs.slug }}
    steps:
      - name: Setup Project Info
        id: setup
        run: |
          SLUG=$(echo "${{ inputs.business_name }}" | tr '[:upper:]' '[:lower:]' | sed 's/[^a-z0-9]/-/g' | sed 's/--*/-/g' | sed 's/^-//' | sed 's/-$//')

          # CRITICAL: Blocklist of reserved project names that must NEVER be overwritten
          RESERVED_NAMES="machinemind-telegram machinemind-landing sofia-brain contentengine moneymachine xclusive-platform"

          for RESERVED in $RESERVED_NAMES; do
            if [ "$SLUG" = "$RESERVED" ]; then
              echo "ERROR: '$SLUG' is a reserved project name!"
              echo "Cannot create project with this name."
              exit 1
            fi
          done

          echo "slug=$SLUG" >> $GITHUB_OUTPUT
          echo "repo_name=$SLUG" >> $GITHUB_OUTPUT

      - name: Create Repository
        run: |
          curl -s -X POST "https://api.github.com/user/repos" \
            -H "Authorization: Bearer ${{ secrets.GH_PAT }}" \
            -H "Content-Type: application/json" \
            -d '{
              "name": "${{ steps.setup.outputs.repo_name }}",
              "description": "${{ inputs.business_name }} - ${{ inputs.sector }} | Genesis Engine Build",
              "private": false,
              "auto_init": true
            }'

      - name: Wait for repo
        run: sleep 5

      - name: Checkout new repo
        uses: actions/checkout@v4
        with:
          repository: Showowt/${{ steps.setup.outputs.repo_name }}
          token: ${{ secrets.GH_PAT }}
          path: project

      - name: Setup Node
        uses: actions/setup-node@v4
        with:
          node-version: '20'

      - name: Generate Genesis Project
        working-directory: project
        env:
          BUSINESS: ${{ inputs.business_name }}
          SECTOR: ${{ inputs.sector }}
          LOCATION: ${{ inputs.location }}
          SLUG: ${{ steps.setup.outputs.slug }}
        run: |
          mkdir -p app components lib public

          # Sector-specific content
          case "$SECTOR" in
            restaurant)
              HERO_TITLE="Experiencia Gastron√≥mica de Lujo"
              HERO_SUB="Sabores excepcionales en un ambiente inolvidable"
              CTA_PRIMARY="Reservar Mesa"
              CTA_SECONDARY="Ver Men√∫"
              SERVICE_1="Men√∫ Degustaci√≥n"
              SERVICE_1_DESC="Experiencia culinaria de 7 tiempos con maridaje de vinos seleccionados"
              SERVICE_2="Chef Privado"
              SERVICE_2_DESC="Servicio exclusivo de chef en mesa con preparaci√≥n en vivo"
              SERVICE_3="Eventos Privados"
              SERVICE_3_DESC="Espacios exclusivos para celebraciones √≠ntimas y corporativas"
              ;;
            hotel)
              HERO_TITLE="Lujo Redefinido"
              HERO_SUB="Donde cada momento se convierte en un recuerdo extraordinario"
              CTA_PRIMARY="Reservar Suite"
              CTA_SECONDARY="Explorar"
              SERVICE_1="Suites de Lujo"
              SERVICE_1_DESC="Espacios amplios con vistas panor√°micas y servicio de mayordomo 24/7"
              SERVICE_2="Spa & Bienestar"
              SERVICE_2_DESC="Centro de relajaci√≥n con tratamientos exclusivos y piscina infinita"
              SERVICE_3="Experiencias √önicas"
              SERVICE_3_DESC="Tours privados, cenas en la terraza y actividades personalizadas"
              ;;
            nightclub)
              HERO_TITLE="Noches Inolvidables"
              HERO_SUB="El epicentro de la vida nocturna exclusiva"
              CTA_PRIMARY="Reservar VIP"
              CTA_SECONDARY="Ver Eventos"
              SERVICE_1="Mesas VIP"
              SERVICE_1_DESC="Servicio de botella premium con atenci√≥n personalizada"
              SERVICE_2="DJs Internacionales"
              SERVICE_2_DESC="Los mejores talentos de la m√∫sica electr√≥nica mundial"
              SERVICE_3="Eventos Privados"
              SERVICE_3_DESC="Fiestas exclusivas y lanzamientos de marca"
              ;;
            yacht)
              HERO_TITLE="Navegaci√≥n de Lujo"
              HERO_SUB="Explora el Caribe desde tu propio yate privado"
              CTA_PRIMARY="Reservar Charter"
              CTA_SECONDARY="Ver Flota"
              SERVICE_1="Charters Privados"
              SERVICE_1_DESC="Yates de lujo con tripulaci√≥n profesional y chef a bordo"
              SERVICE_2="Islas del Rosario"
              SERVICE_2_DESC="Tours exclusivos a las playas m√°s v√≠rgenes del Caribe"
              SERVICE_3="Eventos en el Mar"
              SERVICE_3_DESC="Bodas, cumplea√±os y celebraciones corporativas"
              ;;
            villa)
              HERO_TITLE="Tu Villa Privada"
              HERO_SUB="Lujo, privacidad y servicio excepcional"
              CTA_PRIMARY="Reservar Villa"
              CTA_SECONDARY="Ver Propiedades"
              SERVICE_1="Villas con Piscina"
              SERVICE_1_DESC="Propiedades exclusivas con piscina privada y vistas al mar"
              SERVICE_2="Servicio de Chef"
              SERVICE_2_DESC="Chef privado que prepara men√∫s personalizados"
              SERVICE_3="Concierge 24/7"
              SERVICE_3_DESC="Atenci√≥n personalizada para todas tus necesidades"
              ;;
            spa)
              HERO_TITLE="Santuario de Bienestar"
              HERO_SUB="Renueva cuerpo, mente y esp√≠ritu"
              CTA_PRIMARY="Reservar Tratamiento"
              CTA_SECONDARY="Ver Servicios"
              SERVICE_1="Masajes Terap√©uticos"
              SERVICE_1_DESC="T√©cnicas ancestrales combinadas con aromaterapia premium"
              SERVICE_2="Faciales de Lujo"
              SERVICE_2_DESC="Tratamientos con productos exclusivos y tecnolog√≠a avanzada"
              SERVICE_3="Circuito Spa"
              SERVICE_3_DESC="Sauna, jacuzzi, piscina termal y zona de relajaci√≥n"
              ;;
            tour)
              HERO_TITLE="Experiencias √önicas"
              HERO_SUB="Descubre destinos extraordinarios con gu√≠as expertos"
              CTA_PRIMARY="Reservar Tour"
              CTA_SECONDARY="Ver Experiencias"
              SERVICE_1="Tours Privados"
              SERVICE_1_DESC="Recorridos exclusivos con gu√≠as certificados biling√ºes"
              SERVICE_2="Aventuras"
              SERVICE_2_DESC="Snorkel, buceo, kayak y experiencias de adrenalina"
              SERVICE_3="Cultura Local"
              SERVICE_3_DESC="Inmersi√≥n en tradiciones, gastronom√≠a y artesan√≠as"
              ;;
            *)
              HERO_TITLE="Experiencia Premium"
              HERO_SUB="Servicio excepcional que supera expectativas"
              CTA_PRIMARY="Reservar"
              CTA_SECONDARY="Explorar"
              SERVICE_1="Servicio Premium"
              SERVICE_1_DESC="Atenci√≥n personalizada de clase mundial"
              SERVICE_2="Exclusividad"
              SERVICE_2_DESC="Experiencias √∫nicas dise√±adas para ti"
              SERVICE_3="Excelencia"
              SERVICE_3_DESC="Los m√°s altos est√°ndares de calidad"
              ;;
          esac

          # package.json
          cat > package.json << 'PKGJSON'
          {
            "name": "genesis-project",
            "version": "1.0.0",
            "private": true,
            "scripts": {
              "dev": "next dev",
              "build": "next build",
              "start": "next start",
              "lint": "next lint"
            },
            "dependencies": {
              "next": "^14.2.0",
              "react": "^18.3.0",
              "react-dom": "^18.3.0",
              "@supabase/supabase-js": "^2.45.0",
              "lucide-react": "^0.400.0"
            },
            "devDependencies": {
              "typescript": "^5.5.0",
              "@types/node": "^20.14.0",
              "@types/react": "^18.3.0",
              "@types/react-dom": "^18.3.0",
              "tailwindcss": "^3.4.0",
              "postcss": "^8.4.0",
              "autoprefixer": "^10.4.0"
            }
          }
          PKGJSON

          # tsconfig.json
          cat > tsconfig.json << 'EOF'
          {
            "compilerOptions": {
              "target": "ES2017",
              "lib": ["dom", "dom.iterable", "esnext"],
              "allowJs": true,
              "skipLibCheck": true,
              "strict": true,
              "noEmit": true,
              "esModuleInterop": true,
              "module": "esnext",
              "moduleResolution": "bundler",
              "resolveJsonModule": true,
              "isolatedModules": true,
              "jsx": "preserve",
              "incremental": true,
              "plugins": [{ "name": "next" }],
              "paths": { "@/*": ["./*"] }
            },
            "include": ["next-env.d.ts", "**/*.ts", "**/*.tsx"],
            "exclude": ["node_modules"]
          }
          EOF

          # tailwind.config.js - APEX luxury theme
          cat > tailwind.config.js << 'EOF'
          /** @type {import('tailwindcss').Config} */
          module.exports = {
            content: ["./app/**/*.{ts,tsx}", "./components/**/*.{ts,tsx}"],
            theme: {
              extend: {
                colors: {
                  primary: "#d4af37",
                  dark: "#0f0f1a",
                  darker: "#0a0a12",
                },
                fontFamily: {
                  display: ["Playfair Display", "serif"],
                  body: ["Inter", "sans-serif"],
                }
              }
            },
            plugins: [],
          };
          EOF

          # postcss.config.js
          cat > postcss.config.js << 'EOF'
          module.exports = {
            plugins: {
              tailwindcss: {},
              autoprefixer: {},
            },
          };
          EOF

          # next.config.js
          cat > next.config.js << 'EOF'
          /** @type {import('next').NextConfig} */
          const nextConfig = {};
          module.exports = nextConfig;
          EOF

          # .env.example
          cat > .env.example << 'EOF'
          NEXT_PUBLIC_SUPABASE_URL=your_supabase_url
          NEXT_PUBLIC_SUPABASE_ANON_KEY=your_supabase_anon_key
          SUPABASE_SERVICE_ROLE_KEY=your_service_role_key
          NEXT_PUBLIC_WHATSAPP=+573001234567
          EOF

          # .gitignore
          cat > .gitignore << 'EOF'
          node_modules/
          .next/
          .env
          .env.local
          .vercel
          EOF

          # app/globals.css - APEX luxury styles
          cat > app/globals.css << 'EOF'
          @import url('https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;500;600;700&family=Inter:wght@300;400;500;600&display=swap');

          @tailwind base;
          @tailwind components;
          @tailwind utilities;

          :root {
            --color-primary: #d4af37;
            --color-dark: #0f0f1a;
            --color-darker: #0a0a12;
          }

          body {
            background-color: var(--color-dark);
            color: #ffffff;
            font-family: 'Inter', sans-serif;
          }

          h1, h2, h3, h4 {
            font-family: 'Playfair Display', serif;
          }

          /* No rounded corners - APEX aesthetic */
          * {
            border-radius: 0 !important;
          }

          /* Gold accents */
          .text-gold { color: var(--color-primary); }
          .bg-gold { background-color: var(--color-primary); }
          .border-gold { border-color: var(--color-primary); }

          /* Smooth scrolling */
          html {
            scroll-behavior: smooth;
          }
          EOF

          # app/layout.tsx
          cat > app/layout.tsx << LAYOUTEOF
          import type { Metadata } from "next";
          import "./globals.css";

          export const metadata: Metadata = {
            title: "${BUSINESS}",
            description: "${BUSINESS} - ${HERO_SUB}",
            openGraph: {
              title: "${BUSINESS}",
              description: "${HERO_SUB}",
              type: "website",
            },
          };

          export default function RootLayout({
            children,
          }: {
            children: React.ReactNode;
          }) {
            return (
              <html lang="es">
                <body className="antialiased">{children}</body>
              </html>
            );
          }
          LAYOUTEOF

          # app/page.tsx - Full Genesis page with sector-specific content
          cat > app/page.tsx << PAGEEOF
          import { Phone, MapPin, Clock, Star, ChevronRight, MessageCircle } from "lucide-react";

          export default function Home() {
            return (
              <main className="min-h-screen bg-dark">
                {/* Navigation */}
                <nav className="fixed top-0 w-full z-50 bg-dark/90 backdrop-blur-sm border-b border-gray-800">
                  <div className="max-w-7xl mx-auto px-4 h-16 flex items-center justify-between">
                    <span className="text-xl font-display font-bold text-gold">${BUSINESS}</span>
                    <div className="hidden md:flex gap-8 text-sm">
                      <a href="#servicios" className="hover:text-gold transition">Servicios</a>
                      <a href="#nosotros" className="hover:text-gold transition">Nosotros</a>
                      <a href="#contacto" className="hover:text-gold transition">Contacto</a>
                    </div>
                    <a
                      href="https://wa.me/573001234567"
                      className="bg-gold text-dark px-6 py-2 font-semibold hover:bg-gold/90 transition flex items-center gap-2"
                    >
                      <MessageCircle size={18} />
                      WhatsApp
                    </a>
                  </div>
                </nav>

                {/* Hero Section */}
                <section className="relative min-h-screen flex items-center justify-center pt-16">
                  <div className="absolute inset-0 bg-gradient-to-b from-dark/50 to-dark" />
                  <div className="relative text-center px-4 max-w-4xl mx-auto">
                    <p className="text-gold uppercase tracking-[0.3em] text-sm mb-4">${SECTOR}</p>
                    <h1 className="text-5xl md:text-7xl font-display font-bold mb-6 text-white leading-tight">
                      ${HERO_TITLE}
                    </h1>
                    <p className="text-xl md:text-2xl text-gray-300 mb-10 max-w-2xl mx-auto">
                      ${HERO_SUB}
                    </p>
                    <div className="flex flex-col sm:flex-row gap-4 justify-center">
                      <a
                        href="https://wa.me/573001234567"
                        className="px-10 py-4 bg-gold text-dark font-semibold hover:bg-gold/90 transition text-lg flex items-center justify-center gap-2"
                      >
                        ${CTA_PRIMARY}
                        <ChevronRight size={20} />
                      </a>
                      <a
                        href="#servicios"
                        className="px-10 py-4 border-2 border-gold text-gold hover:bg-gold/10 transition text-lg"
                      >
                        ${CTA_SECONDARY}
                      </a>
                    </div>
                  </div>

                  {/* Scroll indicator */}
                  <div className="absolute bottom-10 left-1/2 -translate-x-1/2 animate-bounce">
                    <div className="w-6 h-10 border-2 border-gold flex justify-center pt-2">
                      <div className="w-1 h-2 bg-gold" />
                    </div>
                  </div>
                </section>

                {/* Services Section */}
                <section id="servicios" className="py-24 px-4 bg-darker">
                  <div className="max-w-6xl mx-auto">
                    <p className="text-gold uppercase tracking-[0.3em] text-sm text-center mb-4">Servicios</p>
                    <h2 className="text-4xl md:text-5xl font-display font-bold text-center mb-16">
                      Experiencias Exclusivas
                    </h2>
                    <div className="grid md:grid-cols-3 gap-8">
                      <div className="p-8 bg-dark border border-gray-800 hover:border-gold transition group">
                        <div className="w-12 h-12 bg-gold/10 flex items-center justify-center mb-6 group-hover:bg-gold/20 transition">
                          <Star className="text-gold" size={24} />
                        </div>
                        <h3 className="text-xl font-display font-semibold mb-4">${SERVICE_1}</h3>
                        <p className="text-gray-400 leading-relaxed">
                          ${SERVICE_1_DESC}
                        </p>
                      </div>
                      <div className="p-8 bg-dark border border-gray-800 hover:border-gold transition group">
                        <div className="w-12 h-12 bg-gold/10 flex items-center justify-center mb-6 group-hover:bg-gold/20 transition">
                          <Star className="text-gold" size={24} />
                        </div>
                        <h3 className="text-xl font-display font-semibold mb-4">${SERVICE_2}</h3>
                        <p className="text-gray-400 leading-relaxed">
                          ${SERVICE_2_DESC}
                        </p>
                      </div>
                      <div className="p-8 bg-dark border border-gray-800 hover:border-gold transition group">
                        <div className="w-12 h-12 bg-gold/10 flex items-center justify-center mb-6 group-hover:bg-gold/20 transition">
                          <Star className="text-gold" size={24} />
                        </div>
                        <h3 className="text-xl font-display font-semibold mb-4">${SERVICE_3}</h3>
                        <p className="text-gray-400 leading-relaxed">
                          ${SERVICE_3_DESC}
                        </p>
                      </div>
                    </div>
                  </div>
                </section>

                {/* About Section */}
                <section id="nosotros" className="py-24 px-4">
                  <div className="max-w-6xl mx-auto grid md:grid-cols-2 gap-16 items-center">
                    <div>
                      <p className="text-gold uppercase tracking-[0.3em] text-sm mb-4">Nosotros</p>
                      <h2 className="text-4xl md:text-5xl font-display font-bold mb-6">
                        Compromiso con la Excelencia
                      </h2>
                      <p className="text-gray-300 leading-relaxed mb-6">
                        En ${BUSINESS}, cada detalle est√° dise√±ado para superar sus expectativas.
                        Nuestro equipo de profesionales dedicados trabaja incansablemente para
                        crear experiencias memorables que perduran en el tiempo.
                      </p>
                      <p className="text-gray-400 leading-relaxed mb-8">
                        Con a√±os de experiencia en el sector ${SECTOR}, hemos perfeccionado
                        el arte de la hospitalidad de lujo, combinando tradici√≥n con innovaci√≥n
                        para ofrecer un servicio incomparable.
                      </p>
                      <div className="flex items-center gap-6">
                        <div className="text-center">
                          <p className="text-4xl font-display font-bold text-gold">5+</p>
                          <p className="text-sm text-gray-400">A√±os</p>
                        </div>
                        <div className="w-px h-12 bg-gray-800" />
                        <div className="text-center">
                          <p className="text-4xl font-display font-bold text-gold">1000+</p>
                          <p className="text-sm text-gray-400">Clientes</p>
                        </div>
                        <div className="w-px h-12 bg-gray-800" />
                        <div className="text-center">
                          <p className="text-4xl font-display font-bold text-gold">4.9</p>
                          <p className="text-sm text-gray-400">Rating</p>
                        </div>
                      </div>
                    </div>
                    <div className="bg-darker border border-gray-800 h-96 flex items-center justify-center">
                      <p className="text-gray-600">Imagen del establecimiento</p>
                    </div>
                  </div>
                </section>

                {/* CTA Section */}
                <section className="py-24 px-4 bg-gold">
                  <div className="max-w-4xl mx-auto text-center">
                    <h2 className="text-4xl md:text-5xl font-display font-bold text-dark mb-6">
                      ¬øListo para una experiencia √∫nica?
                    </h2>
                    <p className="text-dark/80 text-lg mb-10 max-w-2xl mx-auto">
                      Cont√°ctenos hoy y perm√≠tanos crear un momento inolvidable para usted.
                    </p>
                    <a
                      href="https://wa.me/573001234567"
                      className="inline-flex items-center gap-3 px-10 py-4 bg-dark text-white font-semibold hover:bg-darker transition text-lg"
                    >
                      <MessageCircle size={24} />
                      Contactar por WhatsApp
                    </a>
                  </div>
                </section>

                {/* Contact Section */}
                <section id="contacto" className="py-24 px-4 bg-darker">
                  <div className="max-w-6xl mx-auto">
                    <p className="text-gold uppercase tracking-[0.3em] text-sm text-center mb-4">Contacto</p>
                    <h2 className="text-4xl md:text-5xl font-display font-bold text-center mb-16">
                      Encu√©ntrenos
                    </h2>
                    <div className="grid md:grid-cols-3 gap-8 text-center">
                      <div className="p-8">
                        <div className="w-16 h-16 bg-gold/10 flex items-center justify-center mx-auto mb-6">
                          <MapPin className="text-gold" size={28} />
                        </div>
                        <h3 className="font-display font-semibold mb-2">Ubicaci√≥n</h3>
                        <p className="text-gray-400">${LOCATION}</p>
                      </div>
                      <div className="p-8">
                        <div className="w-16 h-16 bg-gold/10 flex items-center justify-center mx-auto mb-6">
                          <Phone className="text-gold" size={28} />
                        </div>
                        <h3 className="font-display font-semibold mb-2">Tel√©fono</h3>
                        <p className="text-gray-400">+57 300 123 4567</p>
                      </div>
                      <div className="p-8">
                        <div className="w-16 h-16 bg-gold/10 flex items-center justify-center mx-auto mb-6">
                          <Clock className="text-gold" size={28} />
                        </div>
                        <h3 className="font-display font-semibold mb-2">Horario</h3>
                        <p className="text-gray-400">Lun - Dom: 9AM - 10PM</p>
                      </div>
                    </div>
                  </div>
                </section>

                {/* Footer */}
                <footer className="py-12 px-4 border-t border-gray-800">
                  <div className="max-w-6xl mx-auto">
                    <div className="flex flex-col md:flex-row justify-between items-center gap-6">
                      <div>
                        <span className="text-2xl font-display font-bold text-gold">${BUSINESS}</span>
                        <p className="text-gray-500 text-sm mt-2">¬© 2024 Todos los derechos reservados.</p>
                      </div>
                      <div className="flex gap-6 text-sm text-gray-400">
                        <a href="#" className="hover:text-gold transition">Privacidad</a>
                        <a href="#" className="hover:text-gold transition">T√©rminos</a>
                        <a href="#" className="hover:text-gold transition">Instagram</a>
                      </div>
                    </div>
                    <p className="text-center text-gray-600 text-xs mt-8">
                      Powered by MachineMind Genesis Engine
                    </p>
                  </div>
                </footer>

                {/* WhatsApp Float Button */}
                <a
                  href="https://wa.me/573001234567"
                  className="fixed bottom-6 right-6 w-16 h-16 bg-green-500 flex items-center justify-center hover:bg-green-600 transition shadow-lg z-50"
                  aria-label="WhatsApp"
                >
                  <MessageCircle size={32} className="text-white" />
                </a>
              </main>
            );
          }
          PAGEEOF

          # lib/supabase.ts
          cat > lib/supabase.ts << 'EOF'
          import { createClient } from "@supabase/supabase-js";

          const supabaseUrl = process.env.NEXT_PUBLIC_SUPABASE_URL!;
          const supabaseAnonKey = process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY!;

          export const supabase = createClient(supabaseUrl, supabaseAnonKey);
          EOF

          # =====================================================
          # SIGNATURE EXPERIENCE COMPONENTS (Engine Protocols v3)
          # =====================================================

          # components/ScrollProgress.tsx - Micro-interaction signature
          cat > components/ScrollProgress.tsx << 'EOF'
          "use client";

          import { useEffect, useState } from "react";

          export function ScrollProgress() {
            const [progress, setProgress] = useState(0);

            useEffect(() => {
              const updateProgress = () => {
                const scrollTop = window.scrollY;
                const docHeight = document.documentElement.scrollHeight - window.innerHeight;
                const scrollPercent = docHeight > 0 ? (scrollTop / docHeight) * 100 : 0;
                setProgress(scrollPercent);
              };

              window.addEventListener("scroll", updateProgress, { passive: true });
              return () => window.removeEventListener("scroll", updateProgress);
            }, []);

            return (
              <div
                className="fixed top-0 left-0 h-1 bg-gold z-[100] transition-all duration-150"
                style={{ width: `${progress}%` }}
                aria-hidden="true"
              />
            );
          }
          EOF

          # components/ConsoleEasterEgg.tsx - Easter egg signature
          cat > components/ConsoleEasterEgg.tsx << 'EGGEOF'
          "use client";

          import { useEffect } from "react";

          export function ConsoleEasterEgg() {
            useEffect(() => {
              const styles = [
                "color: #d4af37",
                "font-size: 20px",
                "font-weight: bold",
                "text-shadow: 2px 2px 4px rgba(0,0,0,0.3)",
              ].join(";");

              console.log("%c‚ö° GENESIS ENGINE", styles);
              console.log(
                "%cPowered by MachineMind | APEX v6 | PROMETHEUS v2",
                "color: #888; font-style: italic;"
              );
              console.log(
                "%cüî• Looking to build something amazing? Contact us!",
                "color: #d4af37;"
              );

              // Add secret menu to window object
              if (typeof window !== "undefined") {
                (window as unknown as Record<string, unknown>).MachineMind = {
                  version: "Genesis v3",
                  contact: "hello@machinemind.ai",
                  secretMenu: () => {
                    console.log("%cüéâ You found the secret menu!", "color: #ff00ff; font-size: 16px;");
                    console.log("Available commands:");
                    console.log("  - MachineMind.version");
                    console.log("  - MachineMind.contact");
                    return "‚ú® You're curious - we like that!";
                  },
                };
              }
            }, []);

            return null;
          }
          EGGEOF

          # components/WhatsAppFloat.tsx - Signature CTA component
          cat > components/WhatsAppFloat.tsx << 'EOF'
          "use client";

          import { MessageCircle } from "lucide-react";

          interface WhatsAppFloatProps {
            phone?: string;
            message?: string;
          }

          export function WhatsAppFloat({
            phone = "573001234567",
            message = "Hola, me gustar√≠a m√°s informaci√≥n",
          }: WhatsAppFloatProps) {
            const encodedMessage = encodeURIComponent(message);
            const whatsappUrl = `https://wa.me/${phone}?text=${encodedMessage}`;

            return (
              <a
                href={whatsappUrl}
                target="_blank"
                rel="noopener noreferrer"
                className="fixed bottom-6 right-6 w-16 h-16 bg-green-500 flex items-center justify-center hover:bg-green-600 transition-all duration-300 hover:scale-105 shadow-lg z-50"
                aria-label="Contactar por WhatsApp"
              >
                <MessageCircle size={32} className="text-white" />
              </a>
            );
          }
          EOF

          # Update app/layout.tsx to include signature components
          cat > app/layout.tsx << LAYOUTEOF
          import type { Metadata } from "next";
          import { ScrollProgress } from "@/components/ScrollProgress";
          import { ConsoleEasterEgg } from "@/components/ConsoleEasterEgg";
          import "./globals.css";

          export const metadata: Metadata = {
            title: "${BUSINESS}",
            description: "${BUSINESS} - ${HERO_SUB}",
            openGraph: {
              title: "${BUSINESS}",
              description: "${HERO_SUB}",
              type: "website",
            },
          };

          export default function RootLayout({
            children,
          }: {
            children: React.ReactNode;
          }) {
            return (
              <html lang="es">
                <body className="antialiased">
                  <ScrollProgress />
                  <ConsoleEasterEgg />
                  {children}
                </body>
              </html>
            );
          }
          LAYOUTEOF

      - name: Commit Project
        working-directory: project
        run: |
          git config user.name "MachineMind Genesis"
          git config user.email "genesis@machinemind.ai"
          git add -A
          git commit -m "‚ö° Genesis Build: ${{ inputs.business_name }} (${{ inputs.sector }})

          Built with ENGINE PROTOCOLS v3:
          - APEX FINISHING ENGINE (12 dimensions)
          - INTERFACE PERFECTION ENGINE (no rounded corners)
          - SIGNATURE EXPERIENCE ENGINE (scroll progress, easter eggs)

          Stack: PROMETHEUS v2 + APEX v6
          - Sector-specific Spanish content
          - Luxury APEX theme (gold #d4af37, Playfair Display)
          - WhatsApp integration + floating CTA
          - Mobile-first responsive (56px touch targets)
          - ZDBS quality standards
          "
          git push

  deploy:
    needs: create-project
    runs-on: ubuntu-latest
    outputs:
      url: ${{ steps.deploy.outputs.url }}
    env:
      # Explicit project name to prevent domain collision
      PROJECT_NAME: ${{ needs.create-project.outputs.repo_name }}
    steps:
      - uses: actions/checkout@v4
        with:
          repository: Showowt/${{ needs.create-project.outputs.repo_name }}
          token: ${{ secrets.GH_PAT }}

      - uses: actions/setup-node@v4
        with:
          node-version: '20'

      - run: npm install

      - run: npm i -g vercel

      - name: Create Isolated Vercel Project
        id: deploy
        run: |
          # CRITICAL: Create a NEW Vercel project with explicit name
          # This prevents collision with machinemind-telegram or other projects

          # Remove any existing .vercel folder to prevent linking to wrong project
          rm -rf .vercel

          # Create new project explicitly with unique name
          # --name flag ensures this deploys to PROJECT_NAME.vercel.app, not any existing project
          vercel link --yes --project="$PROJECT_NAME" --token=${{ secrets.VERCEL_TOKEN }} 2>/dev/null || \
          vercel project add "$PROJECT_NAME" --token=${{ secrets.VERCEL_TOKEN }} 2>/dev/null || true

          # Deploy with explicit project name flag
          DEPLOY_OUTPUT=$(vercel deploy --prod --token=${{ secrets.VERCEL_TOKEN }} --yes --name="$PROJECT_NAME" 2>&1)
          echo "$DEPLOY_OUTPUT"

          # Extract URL - prefer the aliased domain
          URL=$(echo "$DEPLOY_OUTPUT" | grep -oE "https://${PROJECT_NAME}[^ ]*\.vercel\.app" | head -1)

          # Fallback to any vercel.app URL
          if [ -z "$URL" ]; then
            URL=$(echo "$DEPLOY_OUTPUT" | grep -oE 'https://[^ ]+\.vercel\.app' | tail -1)
          fi

          echo "Deployed to: $URL"
          echo "url=$URL" >> $GITHUB_OUTPUT
        continue-on-error: true

  report:
    needs: [create-project, deploy]
    runs-on: ubuntu-latest
    if: always()
    steps:
      - name: Send Genesis Report
        run: |
          REPO="${{ needs.create-project.outputs.repo_name }}"
          URL="${{ needs.deploy.outputs.url }}"

          if [ -n "$URL" ]; then
            STATUS="‚úÖ LIVE"
          else
            STATUS="‚ö†Ô∏è Deploy pending"
            URL="Vercel dashboard"
          fi

          curl -s -X POST "https://api.telegram.org/bot${{ secrets.TELEGRAM_BOT_TOKEN }}/sendMessage" \
            -H "Content-Type: application/json" \
            -d "{
              \"chat_id\": \"${{ inputs.chat_id }}\",
              \"text\": \"‚ö° <b>GENESIS COMPLETE: $STATUS</b>\n\nüè¢ <b>${{ inputs.business_name }}</b>\nüéØ Sector: ${{ inputs.sector }}\nüìç Location: ${{ inputs.location }}\n\n<b>üîó Resources:</b>\nüìÅ <a href=\\\"https://github.com/Showowt/$REPO\\\">GitHub Repo</a>\nüåê <a href=\\\"$URL\\\">Live Site</a>\n\n<b>‚ö° ENGINE PROTOCOLS v3:</b>\n‚Ä¢ APEX FINISHING (12 dimensions)\n‚Ä¢ INTERFACE PERFECTION (no corners)\n‚Ä¢ SIGNATURE EXPERIENCES included\n\n<b>‚ú® Genesis Features:</b>\n‚Ä¢ Scroll progress indicator\n‚Ä¢ Console easter eggs\n‚Ä¢ WhatsApp floating CTA\n‚Ä¢ 56px touch targets\n‚Ä¢ WCAG 4.5:1 contrast\n‚Ä¢ Spanish sector content\n\n<b>üöÄ Next:</b>\n<code>/audit $REPO</code> - Run security scan\",
              \"parse_mode\": \"HTML\",
              \"disable_web_page_preview\": true
            }"
